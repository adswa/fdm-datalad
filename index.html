<!doctype html>
<html lang="en">
<head>
  <title> Brainhack Nordic 2022 </title>
  <meta name="description" content=" incf-2022-lightning-jsheunis ">
  <meta name="author" content=" Stephan Heunis ">

  <meta charset="utf-8">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/dist/reset.css">
  <link rel="stylesheet" href="reveal.js/dist/reveal.css">
  <link rel="stylesheet" href="reveal.js/dist/theme/beige.css">
  <!-- Theme used for syntax highlighted code -->
  <link rel="stylesheet" href="reveal.js/plugin/highlight/monokai.css">
  <link rel="stylesheet" href="custom_styles.css">
</head>
<body>

<div class="reveal">
<div class="slides">

<!-- FRONT PAGE -->
<section>
    <h2 style="margin-bottom: 0;">BrainHack Nordic 2022</h2>
    <img src="pics/datalad_git.svg" style="height:300px; margin-bottom: 0;" alt="title image">
    <div style="margin-top:0.5em;">
        <table style="border: none;">
            <tr>
                <td>Stephan Heunis
                <br>
                <small>
                    <a href="https://twitter.com/fMRwhy" target="_blank">
                    <img data-src="pics/twitter.png" style="height:30px;margin:0px" />
                    @fMRwhy
                    </a>
                </small>
                <small>
                    <a href="https://github.com/jsheunis" target="_blank">
                    <img data-src="pics/GitHub.png" style="height:30px;margin:0px" />
                    jsheunis
                    </a>
                </small>
                </td>
                <td><img style="height:100px;margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="pics/fzj_logo.svg" /></td>
            </tr>
        </table>
    </div>
    <p style="text-align: center;">
        <small><a href="http://psychoinformatics.de" target="_blank">Psychoinformatics lab</a>
            <br>
            Institute of Neuroscience and Medicine, Brain &amp; Behavior (INM-7), Germany
            <br>
        </small>
    </p>
    <br>
    <div>
        <small>Slides:&nbsp;</small><a href="https://jsheunis.github.io/brainhack-nordic-datalad"><small>jsheunis.github.io/brainhack-nordic-datalad</small></a>
    </div>
</section>


<section>
    <h2>Acknowledgements</h2>

    <div style="margin-top:0.5em;">
        <table style="border: none;">
            <tr>
                <td><img style="height:500px;margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="pics/funders.svg" /></td>
                <td><img style="height:500px;margin-right:1px;margin-bottom:10px;vertical-align:middle;border:1px solid black" data-src="pics/psyinf_team.png" /></td>
            </tr>
        </table>
    </div>
    <ul>
        <li>The People with Money</li>
        <li>The Psychoinformatics + DataLad teams</li>
        <li>All contributors to the open-source DataLad ecosystem</li>
        <li>Cyril and Melanie, and the host institution</li>
    </ul>
</section>


<section>
    <h2>A couple of things about me...</h2>
    <ul>
        <li>I'm a research software engineer at FZ JÃ¼lich. My background:</li>
        <ul>
            <li>Studied engineering (robotics) in South Africa</li>
            <li>Worked for large company and then a tiny startup</li>
            <li>Moved to the Netherlands to do a Phd in neuroimage processing</li>
            <li>Started my current job at FZJ in Germany</li>
        </ul>
        <li>I passionately like: open and inclusive science, programming, learning, a South African "braai"</li>
        <li>I passionately dislike: hierarchies, systemic mysogyny/racism/ableism, any form of admin</li>
    </ul>
</section>


<section>
    <h3>A couple of things about YOU...</h3>
    <a href="http://etc.ch/AHNN" target="_blank">http://etc.ch/AHNN</a><br>
    <a href="http://etc.ch/AHNN" target="_blank"><img data-src="pics/directpollqr.png" /></a>
</section>


<section>
    <h2>Agenda</h2>
    <ol>
        <li>Context</li>
        <li>Practical aspects</li>
        <li>Get cracking!</li>
    </ol>
</section>


<section>
    <h2>1. The Context</h2>
    <div style="margin-top:0.5em;">
        <table style="border: none;" table-layout: fixed;>
            <tr>
                <td width="50%"><img style="height:500px; margin-top: 0; margin-right:1px;vertical-align:middle;" data-src="pics/comic_box1.svg" /></td>
                <td>
                    <ul style="vertical-align:middle;">
                        <li class="fragment fade-in-then-semi-out">Alice is a PhD student in a research team.</li>
                        <li class="fragment fade-in-then-semi-out">She works on a fairly typical research project: data collection & processing.</li>
                        <li class="fragment fade-in-then-semi-out">First sample â†’ final result = cumulative process</li>
                    </ul>
                </td>
            </tr>
        </table>
    </div>
    <h3 class="fragment fade-in-then-semi-out">How does Alice go about her daily job?*</h3>
</section>


<section>
    <h2>1. The Context</h2>
    <ul>
        <li class="fragment fade-in-then-semi-out">When working locally, Alice likes to have an automated record of:
            <ul>
                <li>when a given file was last changed</li>
                <li>where it came from</li>
                <li>what input files were used to generate a given output</li>
                <li>why some things were done.</li>
            </ul>
        </li>
        <li class="fragment fade-in-then-semi-out">Even if she doesn't share her work, this is essential for her future self</li>
        <li class="fragment fade-in-then-semi-out">Project is exploratory: often large changes to her analysis scripts</li>
        <li class="fragment fade-in-then-semi-out">She enjoys the comfort of being able to return to a previously recorded state</li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in-then-semi-out">This is: *local version control*</h3>
</section>


<section>
    <h2>1. The Context</h2>
    <ul>
        <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Alice's work is not confined to a single computer:
            <ul>
                <li>laptop / desktop / remote server</li>
                <li>there should be an automatic+efficient way to synchronize</li>
            </ul>
        </li>
        <li class="fragment fade-in-then-semi-out" data-fragment-index="2">Parts of the data are collected or analysed by colleagues from another team. This requires:
            <ul>
                <li>distributed synchronization with centralized storage</li>
                <li>preservation of origin & authorship of changes</li>
                <li>effective combination of simultaneous contributions</li>
            </ul>
        </li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in-then-semi-out" data-fragment-index="3">This is: *distributed version control*</h3>
</section>


<section>
    <h2>1. The Context</h2>
    <ul>
        <li class="fragment fade-in-then-semi-out">Alice applies local version control for her own work</li>
        <li class="fragment fade-in-then-semi-out">She also applies distributed version control when working with colleagues and collaborators</li>

        <li class="fragment fade-in-then-semi-out">She often needs to work on a subset of data at any given time:
            <ul>
                <li>all files are kept on a server</li>
                <li>a few files are rotated into and out of her laptop</li>
            </ul>
        </li>
        <li class="fragment fade-in-then-semi-out">Alice needs to publish the data at project's end:
            <ul>
                <li>raw data / outputs / both</li>
                <li>completely or selectively</li>
            </ul>
        </li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in-then-semi-out">This is: *data management (with DataLad ðŸ˜€)*</h3>
</section>


<section>
    <h2>1. The Context</h2>
    <img src="pics/comic_box3.svg" alt="">
</section>


<section>
    <h2>2. Practical aspects</h2>
    <br>

    <ul>
        <li class="fragment">Information:<br>
            &nbsp;&nbsp;&nbsp;- <a href="https://github.com/jsheunis/brainhack-nordic-datalad">github.com/jsheunis/brainhack-nordic-datalad</a>
        </li>
        <li class="fragment">Slides:<br>
            &nbsp;&nbsp;&nbsp;- <a href="https://jsheunis.github.io/brainhack-nordic-datalad">jsheunis.github.io/brainhack-nordic-datalad</a>
        </li>
        <li class="fragment">Cloud-computing environment:<br>
            &nbsp;&nbsp;&nbsp;- <a href="https://datalad-hub.inm7.de">datalad-hub.inm7.de</a>
        </li>
        <li class="fragment">Format:
            <ul>
                <li>Hands-on</li>
                <li>Work on your own machine in the browser</li>
                <li>Step-by-step code execution</li>
                <li>Ask questions any time!</li>
            </ul>
        </li>
        <li class="fragment">Timing:
            <ul>
                <li>2 hrs (including intro)</li>
                <li>Short break at 1hr</li>
            </ul>
        </li>
    </ul>
</section>


<section>
    <h2>2. Practical aspects</h2>
    <img width="200" src="pics/jupyter_logo.png" alt="jupyterlogo"><br>
    <ul>
        <li>We'll work in the browser on a cloud server with JupyterHub</li>
        <li class="fragment">We have pre-installed DataLad and other requirements</li>
        <li class="fragment">We will work via the terminal</li>
        <li class="fragment">Log in using the email address with which you registered for the brainhack</li>
        <li class="fragment">Select a password when logging in for the first time; remember it!</li>
    </ul>
</section>


<section>
    <h2>3. So let's do this!</h2>
    <br><br>
    <iframe src="https://giphy.com/embed/bpSJSlawHPChr9oOq4" width="720" height="405" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
</section>


<section style="text-align: left;">
    <h3>datalad</h3>

    Check the installed version:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad --version
        </code>
        <p id="displayArea"></p>
    </pre>

    <div class="fragment">
        For help on using DataLad from the command line:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad --help
            </code>
        </pre>
    </div>

    <div class="fragment">
        For extensive info about the installed package, its dependencies, and extensions, use <code>wtf</code>:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad wtf
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>git identity</h3>
    Check git identity:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            git config --get user.name
            git config --get user.email
        </code>
    </pre>

    <div class="fragment">
        Configure git identity:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git config --global user.name "Stephan Heunis"
                git config --global user.email "s.heunis@fz-juelich.de"
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>Using datalad via its Python API</h3>
    Open a Python environment:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            ipython
        </code>
    </pre>
    <div class="fragment">
        Import and start using:
        <pre style="margin-left: 0;">
            <code data-trim class="language-python" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                import datalad.api as dl
                dl.create(path='mydataset')
            </code>
        </pre>
    </div>
    <div class="fragment">
        Exit the Python environment:
        <pre style="margin-left: 0;">
            <code data-trim class="language-python" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                exit
            </code>
        </pre>
    </div>
</section>

<section>
    <h3 style="text-align: left;">Datalad datasets...</h3>
    <img src="pics/comic_box4.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Datalad datasets</h3>
    Create a dataset (here, with the <code>text2git</code> config):
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad create -c text2git bids-data
        </code>
    </pre>

    <div class="fragment">
        Let's have a look inside. Navigate using <code>cd</code> (change directory):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd bids-data
            </code>
        </pre>
    </div>

    <div class="fragment">
        List the directory content, including hidden files, with <code>ls</code>:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                ls -la .
            </code>
        </pre>
    </div>
</section>


<section>
    <h3 style="text-align: left;">Version control...</h3>
    <img src="pics/comic_box5.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Version control</h3>
    Let's add some Markdown text to a README file in the dataset
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            echo "# A BIDS structured dataset for my input data" > README.md
        </code>
    </pre>

    <div class="fragment">
        Now we can check the <code>status</code> of the dataset:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad status
            </code>
        </pre>
    </div>

    <div class="fragment">
        We can save the state with <code>save</code>
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad save -m "Add a short README"
            </code>
        </pre>
    </div>

    <div class="fragment">
        Further modifications:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                echo "Contains functional task data of one subject" >> README.md
            </code>
        </pre>
    </div>

    <div class="fragment">
        Save again:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad save -m "Add information on the dataset contents to the README"
            </code>
        </pre>
    </div>

    <div class="fragment">
        Now, let's check the dataset history:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git log
            </code>
        </pre>
    </div>
</section>


<section>
    <h3 style="text-align: left;">Data consumption & transport...</h3>
    <img src="pics/comic_box6_consumption.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Data consumption & transport...</h3>

    Install a dataset from remote URL (or local path) using <code>clone</code>:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            cd ../
            datalad clone \
            https://github.com/psychoinformatics-de/studyforrest-data-phase2.git
        </code>
    </pre>
    <div class="fragment">
        We can now view the cloned dataset's file tree:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd studyforrest-data-phase2
                ls
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's check the dataset size (i.e. git repository):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                du -sh # this will print the size of the directory in human readable sizes
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's check the <em>actual</em> dataset size (i.e. git repository + annexed content):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad status --annex
            </code>
        </pre>
    </div>

    <div class="fragment">
        The DataLad dataset is just the git repository,
        i.e. the metadata of all files in the dataset,
        including the content of all files comitted to git.
        The actual file content in the annex can be retrieved as needed.
    </div>
</section>


<section style="text-align: left;">
    <h3>...Data consumption & transport</h3>

    We can retrieve actual file content with <code>get</code> (here, multiple files):
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            # get all files of sub-01 for all functional runs of the localizer task
            datalad get \
            sub-01/ses-localizer/func/sub-01_ses-localizer_task-objectcategories_run-*.nii.gz
        </code>
    </pre>

    <div class="fragment">
        If we don't need a file locally anymore, we can <code>drop</code> it:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                # drop a specific file
                datalad drop \
                sub-01/ses-localizer/func/sub-01_ses-localizer_task-objectcategories_run-4_bold.nii.gz
            </code>
        </pre>
    </div>

    <div class="fragment">
        And it's no problem if you need that exact file again, just <code>get</code>it:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                # get a specific file
                datalad drop \
                sub-01/ses-localizer/func/sub-01_ses-localizer_task-objectcategories_run-4_bold.nii.gz
            </code>
        </pre>
    </div>

    <div class="fragment">
        Therefore: no need to store all files locally.
        Data just needs to be available from at least one location,
        then you can <code>get</code> what you want when you need it,
        and <code>drop</code> the rest.
    </div>
</section>


<section style="text-align: left;">
    <h3>Dataset nesting...</h3>

    Datasets can be nested in superdataset-subdataset hierarchies:

    <img src="pics/linkage_subds.png" alt="">
    
    <ul class="fragment">
        <li>Helps with scaling (see e.g. the <a href="https://github.com/datalad-datasets/human-connectome-project-openaccess">Human Connectome Project dataset</a> )</li>
        <li>Version control tools struggle with >100k files</li>
        <li>Modular units improves intuitive structure and reuse potential</li>
        <li>Versioned linkage of inputs for reproducibility</li>
    </ul>
</section>


<section style="text-align: left;">
    <h3>...Dataset nesting</h3>

    Let's make a nest! First we navigate into the top-level dataset:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            cd ../bids-data
        </code>
    </pre>

    <div class="fragment">
        Then we clone the input dataset into a specific location in the file tree of the existing dataset, making it a <em>sub</em>dataset (using the <code>-d/--dataset</code> flag):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad clone --dataset . \
                https://github.com/datalad/example-dicom-functional.git  \
                inputs/rawdata
            </code>
        </pre>
    </div>

    <div class="fragment">
        Similarly, we can clone the analysis container (actually, a set of containers from <a href="https://www.repronim.org/">ReproNim</a>) as a subdataset:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad clone -d . \
                https://github.com/ReproNim/containers.git \
                code/containers
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's see what changed in the dataset, using the <code>subdatasets</code> command:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad subdatasets
            </code>
        </pre>
    </div>
</section>


<section>
    <h3 style="text-align: left;">Computationally reproducible execution...</h3>
    <img src="pics/comic_box7.svg" width="65%" alt="">
    <ul>
        <li class="fragment fade-in-then-semi-out">which script/pipeline version</li>
        <li class="fragment fade-in-then-semi-out">was run on which version of the data</li>
        <li class="fragment fade-in-then-semi-out">to produce which version of the results?</li>
    </ul>
</section>

<section style="text-align: left;">
    <h3>...Computationally reproducible execution...</h3>

    <ul>
        <li class="fragment fade-in-then-semi-out">The <code>datalad run</code> can run any command in a way that links the command or script to the results it produces and the data it was computed from</li>
        <li class="fragment fade-in-then-semi-out">The <code>datalad rerun</code> can take this recorded provenance and recompute the command</li>
        <li class="fragment fade-in-then-semi-out">The <code>datalad containers-run</code> (from the extension) can capture software provenance in the form of software containers in addition to the provenance that datalad run captures</li>
    </ul>
    <br><br>

    <div class="fragment">
        With the <code>datalad-container</code> extension, we can inspect the list of registered containers (recursively):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad containers-list --recursive
            </code>
        </pre>
    </div>

    <div class="fragment">
        We'll use the <code>repronim-reproin</code> container for dicom conversion.
    </div>

</section>


<section style="text-align: left;">
    <h3>...Computationally reproducible execution</h3>

    Now, let's try out the <code>containers-run</code> command:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad containers-run -m "Convert subject 02 to BIDS" \
            --container-name code/containers/repronim-reproin \
            --input inputs/rawdata/dicoms \
            --output sub-02 \
            "-f reproin -s 02 --bids -l '' --minmeta -o . --files inputs/rawdata/dicoms"
        </code>
    </pre>
    <div class="fragment">
        What changed after the <code>containers-run</code> command has completed?
        <br>
        We can use <code>datalad diff</code> (based on <code>git diff</code>):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad diff -f HEAD~1
            </code>
        </pre>    
    </div>

    <div class="fragment">
        We see that some files were added to the dataset!
        <br>
        And we have a complete provenance record as part of the git history:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git log -n 1
            </code>
        </pre>
    </div>
</section>


<section>
    <h3 style="text-align: left;">Publishing datasets...</h3>
    <div style="margin-top:1em;">
        <table style="border: none;">
            <tr>
                <td><img style="width: 800px; margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="pics/comic_box6_publishing.svg" /></td>
                <td><img style="width: 1000px; margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="pics/comic_box9.svg" /></td>
            </tr>
        </table>
    </div>
    <br>
    <div class="fragment">We will use GIN: <a href="https://gin.g-node.org/">gin.g-node.org</a>:</div>
    <br>
    <ol>
        <li class="fragment">Create a GIN user account and log in</li>
        <li class="fragment"><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent?platform=linux">Create</a> and <a href="https://handbook.datalad.org/en/latest/basics/101-139-gin.html#prerequisites">upload</a> an SSH key to GIN</li>
        <li class="fragment">Create a new <em><strong>empty</strong></em> repository named "bids-data" and copy it's SSH URL</li>
    </ol>
</section>


<section style="text-align: left;">
    <h3>...Publishing datasets</h3>

    DataLad allows you to add repositories as <code>siblings</code> to a dataset, to which data can be published with <code>push</code>.
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad siblings add -d . \
            --name gin \
            --url git@gin.g-node.org:/your-gin-username/bids-data.git
        </code>
    </pre>

    <div class="fragment">
        You can verify the dataset's siblings with the <code>siblings</code> command:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad siblings
            </code>
        </pre>
    </div>

    <div class="fragment">
        And we can push our complete dataset (git repository and annex) to GIN:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad push --to gin
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>Using published data...</h3>

    Let's use our published data in a new analysis, to demonstrate reusability and the usefulness of modularity.
    <br><br>
    First let's create a new dataset using the <a href="https://handbook.datalad.org/en/latest/basics/101-127-yoda.html#yoda">yoda principles</a>:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            cd ../
            datalad create -c yoda myanalysis
        </code>
    </pre>

    <div class="fragment">
        Then we can clone our GIN-published dataset as a subdataset <br>
        (<strong>NB:</strong> use the browser URL without ".git" suffix):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd myanalysis
                datalad clone -d . \
                https://gin.g-node.org/your-gin-username/bids-data \
                input
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>...Using published data...</h3>

    We have data, and now we need an analysis script.
    We will use DataLad's <code>download-url</code> which gets the content of a script and registers its source:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad download-url -m "Download code for brain masking from Github" \
            -O code/get_brainmask.py \
            https://raw.githubusercontent.com/datalad-handbook/resources/master/get_brainmask.py
        </code>
    </pre>

    <div class="fragment">
        Now we have data and an analysis script, and we still need the correct software environment within which the run the analysis.
        We will again use the <code>datalad-container</code> extension to register a container to the new dataset:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad containers-add nilearn \
                --url shub://adswa/nilearn-container:latest \
                --call-fmt "singularity exec {img} {cmd}"
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>...Using published data</h3>

    Finally, we can run the analysis:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad containers-run -m "Compute brain mask" \
            -n nilearn \
            --input input/sub-02/func/sub-02_task-oneback_run-01_bold.nii.gz \
            --output figures/ \
            --output "sub-02*" \
            "python code/get_brainmask.py"
        </code>
    </pre>

    <div class="fragment">
        Afterwards, we can inspect how specific files came to be, e.g.:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git log sub-02_brain-mask.nii.gz
            </code>
        </pre>
    </div>

    <div class="fragment">
        And since the run-record is part of the dataset's git history, we know the provenance.
        DataLad can use this machine-readable information to <em>rerun</em> the analysis without you having to specify any information again:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad rerun
            </code>
        </pre>
    </div>
</section>


<section>
    <h3>The end! For now...</h3>

    <img src="pics/comic_box10.svg" alt="">
</section>
<!-- 

<section>
    <h2>2. DataLad: an overview</h2>
    <img src="pics/comic_box8.svg" alt="">
</section>

<section>
    <h2>2. DataLad: an overview</h2>
    <img src="pics/comic_box9.svg" alt="">
</section>

<section>
    <h2>2. DataLad: an overview</h2>
    <img src="pics/comic_box10.svg" alt="">
</section> -->




</div> <!-- /.slides -->
</div> <!-- /.reveal -->

<script src="reveal.js/dist/reveal.js"></script>
<script src="reveal.js/plugin/notes/notes.js"></script>
<script src="reveal.js/plugin/markdown/markdown.js"></script>
<script src="reveal.js/plugin/highlight/highlight.js"></script>
<script src="custom_functions.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>
<script src="reveal.js/plugin/copycode/copycode.js"></script> -->
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,
        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,
        height: 960,
        // Factor of the display size that should remain empty around the content
        margin: 0.02,
        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.2,
        maxScale: 1.0,

        controls: true,
        progress: true,
        history: true,
        center: false,
        slideNumber: 'c',
        pdfSeparateFragments: false,
        pdfMaxPagesPerSlide: 1,
        pdfPageHeightOffset: -1,
        transition: 'slide', // none/fade/slide/convex/concave/zoom
        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
    });
</script>
</body>
</html>